<header class="pg-header">
  <div class="logo" style="display:flex;align-items:center;gap:8px">
    <a href="/" aria-label="Pocket Guard home" style="display:flex;align-items:center;gap:8px;text-decoration:none;color:inherit">
      <img src="/img/logo.svg" alt="Pocket Guard" class="logo-img" width="28" height="28" onerror="this.style.display='none'; this.closest('.logo')?.classList.add('no-logo')" />
      <span class="logo-fallback" aria-hidden="true">PG</span>
      <span class="logo-text">Pocket Guard</span>
    </a>
  </div>
  <div class="actions" style="display:flex;align-items:center;gap:8px">
    <button id="toggle-theme" class="btn btn-ghost" type="button" aria-label="Toggle theme">
      <span class="material-icons-round" aria-hidden="true">contrast</span>
    </button>
    <% if (currentUserId) { %>
      <a href="/profile" class="btn btn-ghost" aria-label="Profile"><span class="material-icons-round">account_circle</span></a>
      <form action="/logout" method="post" style="display:inline"><button class="btn btn-primary">Log out</button></form>
    <% } else { %>
      <a href="/login" class="btn btn-ghost">Log in</a>
    <% } %>
  </div>
  <script>
    (function(){
      const key = 'pg-theme';
      const apply = (t)=>{ document.documentElement.dataset.theme = t; };
      const saved = localStorage.getItem(key) || (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light');
      apply(saved);
      document.addEventListener('DOMContentLoaded',()=>{
        const btn = document.getElementById('toggle-theme');
        if (!btn) return;
        btn.addEventListener('click',()=>{
          const next = (document.documentElement.dataset.theme === 'dark') ? 'light' : 'dark';
          localStorage.setItem(key, next); apply(next);
        });
      });
    })();
  </script>
</header>

@use 'variables' as *;

* { box-sizing: border-box; }
html, body { margin:0; padding:0; font-family: 'Inter', system-ui, -apple-system, Segoe UI, Roboto, sans-serif; color:$text; background:$bg; }
a { color: $primary; text-decoration: none; }
.container { max-width: 960px; margin: 0 auto; padding: 16px; }
.pg-header { display:flex; justify-content:space-between; align-items:center; padding:12px 16px; background:$card; border-bottom:1px solid $border; position:sticky; top:0; z-index:10; backdrop-filter: saturate(1.2) blur(6px); }
.pg-header .logo { font-weight:700; color:$primary; }

.btn { display:inline-block; padding:10px 16px; border-radius:$radius; background:#eaeaea; border:1px solid transparent; cursor:pointer; transition: all .2s ease; box-shadow: 0 2px 6px rgba(0,0,0,0.04); }
.btn:hover { transform: translateY(-1px); box-shadow: 0 4px 12px rgba(0,0,0,0.08); }
.btn:active { transform: translateY(0); filter: brightness(.98); }
.btn:focus { outline: 3px solid rgba($primary, .2); }
.btn-primary { background:$primary; color:white; }
.btn-primary:hover { filter: brightness(1.05); }
.btn-ghost { background:transparent; color:$primary; border:1px solid $primary; }
.btn-ghost:hover { background: rgba($primary, 0.06); }

.card { background:$card; border-radius:$radius; padding:16px; box-shadow:$shadow; margin:12px 0; border:1px solid $border; transition: transform .2s ease, box-shadow .2s ease; }
.card:hover { transform: translateY(-2px); box-shadow: 0 12px 28px rgba(0,0,0,0.12); }
.grid { display:grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap:12px; }
.alert { padding:12px; border-radius:$radius; }
.alert-error { background:#ffebee; color:$error; }
.muted { color:$muted; }

.pg-bottom-nav { position: fixed; bottom:0; left:0; right:0; background:$card; border-top:1px solid $border; display:flex; justify-content:space-around; padding:8px 0; box-shadow: 0 -4px 12px rgba(0,0,0,0.04); }
.pg-bottom-nav .nav-item { display:flex; flex-direction:column; align-items:center; font-size:12px; color:$text2; padding:6px 10px; border-radius:10px; transition: color .2s ease, transform .2s ease, background .2s ease; }
.pg-bottom-nav .nav-item .material-icons-round { font-size:22px; margin-bottom:2px; }
.pg-bottom-nav .nav-item:hover { background: rgba($primary, 0.06); transform: translateY(-1px); }
.pg-bottom-nav .nav-item.active { color:$primary; }
.pg-bottom-nav .nav-item.active .material-icons-round { animation: pop .25s ease; }
@keyframes pop { 0%{transform: translateY(2px) scale(.98)} 100%{transform: translateY(0) scale(1)} }
.pg-footer { text-align:center; padding:24px; color:$muted; }

/* Pages */
.welcome .hero { text-align:center; padding:40px 0; }
.welcome .hero { position:relative; border-radius:16px; overflow:hidden; background:linear-gradient(135deg, rgba($primary,.10), rgba($secondary,.18)); padding:56px 24px; margin-top:12px; }
.welcome .hero:before { content:""; position:absolute; inset:-40% -20% auto auto; background:radial-gradient(600px 600px at 100% 0, rgba($secondary,.35), transparent 60%); }
.welcome .hero .hero-content { position:relative; z-index:1; }
.welcome .hero .btn-cta { transform:translateZ(0); transition: transform .15s ease, box-shadow .2s ease; }
.welcome .hero .btn-cta:hover { transform: translateY(-1px); }
.welcome .hero .btn-cta:active { transform: translateY(0); }
.welcome .benefits { list-style: none; padding:0; display:flex; justify-content:center; gap:12px; }
.welcome .features.grid { margin-top:16px; }
.welcome .features .tile { background:$card; border:1px solid $border; border-radius:$radius; padding:14px; display:flex; align-items:center; gap:12px; box-shadow:$shadow; }
.welcome .features .tile .icon { background:rgba($primary,.08); color:$primary; width:40px; height:40px; border-radius:12px; display:flex; align-items:center; justify-content:center; }
.welcome .trust-bar { display:flex; align-items:center; gap:8px; justify-content:center; color:#777; margin:12px 0; }
.welcome .cta-strip { display:flex; align-items:center; justify-content:space-between; gap:12px; margin:12px 0; }

.auth form.card { display:flex; flex-direction:column; gap:8px; max-width:420px; }
.auth label { display:flex; flex-direction:column; gap:4px; }
.auth input { padding:10px; border-radius:8px; border:1px solid #ddd; color:#111; background:#fff; }
.alt-auth { display:flex; gap:8px; margin-top:8px; }

.dashboard .gauge { font-size:40px; font-weight:700; text-align:center; padding:12px; }
.dashboard .gauge-circle { position:relative; width:220px; height:220px; margin: 8px auto 16px; }
.dashboard .gauge-circle .meter { width:100%; height:100%; transform: rotate(-90deg); }
.dashboard .gauge-circle .meter .bg { fill:none; stroke:#eee; stroke-width:10; }
.dashboard .gauge-circle .meter .fg { fill:none; stroke:$secondary; stroke-linecap:round; stroke-width:10; transition: stroke-dashoffset 1.2s cubic-bezier(.2,.8,.2,1); }
.dashboard .gauge-circle .value { position:absolute; inset:0; display:flex; align-items:center; justify-content:center; font-size:24px; font-weight:700; }
.dashboard .safe-to-spend .gauge { transition: color .3s ease; }
.snapshot .tile { background:$card; border-radius:$radius; padding:12px; box-shadow:0 1px 3px rgba(0,0,0,0.06); }
.snapshot .tile { display:flex; flex-direction:column; gap:8px; border:1px solid $border; box-shadow:$shadow; transition: transform .2s ease, box-shadow .2s ease; }
.snapshot .tile:hover { transform: translateY(-2px); box-shadow: 0 12px 28px rgba(0,0,0,0.12); }

// Modern snapshot tiles
.snapshot .tile { padding:14px; align-items:center; justify-content:space-between; gap:12px; flex-direction:row; }
.snapshot .tile .icon { background:rgba($primary,.08); color:$primary; width:40px; height:40px; border-radius:12px; display:flex; align-items:center; justify-content:center; }
.snapshot .tile .icon .material-icons-round { font-size:22px; }
.snapshot .tile .metric { display:flex; flex-direction:column; }
.snapshot .tile .metric .value { font-weight:700; }
.snapshot .tile .metric .label { color:#777; font-size:12px; }
.snapshot .tile .badge { padding:6px 10px; border-radius:999px; font-size:12px; border:1px solid #E0E0E0; background:#fafafa; }
.snapshot .tile .badge.good { background:rgba(76,175,80,.08); border-color:rgba(76,175,80,.2); color:#2e7d32; }
.snapshot .tile .badge.neutral { background:rgba(255,193,7,.1); border-color:rgba(255,193,7,.3); color:#795548; }
.snapshot .tile .badge.warn { background:#ffebee; border-color:#ffcdd2; color:#b00020; }
.recent .tx-list { list-style:none; padding:0; }
.recent li { display:grid; grid-template-columns: 110px 1fr 120px; padding:8px 0; border-bottom:1px solid #f0f0f0; }
.amount.neg { color:#b00020; }
.amount.pos { color:#2e7d32; }

.categories .cat .bar { height:8px; background:#eee; border-radius:999px; overflow:hidden; }
.categories .cat .fill { height:8px; background: linear-gradient(90deg, $accent, $accent2); transition: width .8s cubic-bezier(.2,.8,.2,1); }

.goals .goal .bar { height:10px; background:#eee; border-radius:999px; overflow:hidden; }
.goals .goal .fill { height:10px; background: linear-gradient(90deg, $primary, $accent); transition: width .8s cubic-bezier(.2,.8,.2,1); box-shadow: inset 0 0 8px rgba(0,0,0,0.08); }
.goals .goal .stats { margin-top:6px; color:$muted; }
.goals .create { display:flex; gap:8px; flex-wrap:wrap; }

.buddy .chat-log { max-height: 320px; overflow:auto; display:flex; flex-direction:column; gap:8px; }
.buddy .bubble { padding:10px 12px; border-radius:16px; max-width: 80%; animation: slideIn .2s ease; }
.buddy .bubble.ai { background:rgba($secondary, .16); border:1px solid rgba($secondary, .35); }
.buddy .bubble.me { background:#fff; border:1px solid $border; }
.buddy .chat-input { display:flex; gap:8px; margin-top:8px; position:sticky; bottom:76px; background:$bg; padding:6px 0; }
.buddy .chat-input input { flex:1; padding:12px; border-radius:10px; border:1px solid $border; transition: box-shadow .2s ease, border-color .2s ease; }
.buddy .chat-input input:focus { border-color:$primary; box-shadow:0 0 0 4px rgba($primary,.12); }
@keyframes slideIn { from { transform: translateY(6px); opacity: .0 } to { transform: translateY(0); opacity: 1 } }
/* unify bubbles using theme */
.buddy .bubble.ai { align-self:flex-start; }
.buddy .bubble.me { background:#fff; align-self:flex-end; }
.buddy .chat-input { display:flex; gap:8px; margin-top:8px; }
.buddy .chat-input input { flex:1; padding:10px; border-radius:8px; border:1px solid $border; }

.onboarding .goal-row { display:flex; gap:8px; margin-bottom:8px; }
.onboarding input { padding:12px; border-radius:10px; border:1px solid $border; transition: box-shadow .2s ease, border-color .2s ease; }
.onboarding .goal-row { animation: slideIn .2s ease; }
.onboarding input:focus { border-color:$primary; box-shadow: 0 0 0 4px rgba($primary,.12); }

.profile section.card label { display:block; margin:6px 0; }

/* Spinner */
.spinner { width:18px; height:18px; border-radius:50%; border:3px solid rgba(0,0,0,.1); border-top-color:$primary; animation: spin .6s linear infinite; display:inline-block; }
@keyframes spin { to { transform: rotate(360deg) } }

@media (min-width: 960px) {
  .pg-bottom-nav { position:sticky; bottom:auto; }
}

/* --- Enhancements & utilities (theming-aware) --- */
/* Skip link */
.skip-link { position:absolute; left:-9999px; top:auto; width:1px; height:1px; overflow:hidden; }
.skip-link:focus { left:8px; top:8px; width:auto; height:auto; background:$primary; color:#fff; padding:8px 12px; border-radius:10px; z-index:1000; box-shadow:0 8px 24px rgba(0,0,0,.2); }

/* Toasts */
.toast-container { position:fixed; right:12px; top:12px; display:flex; flex-direction:column; gap:8px; z-index:2000; pointer-events:none; }
.toast { pointer-events:auto; display:flex; align-items:flex-start; gap:8px; min-width:240px; max-width:360px; padding:10px 12px; border-radius:12px; border:1px solid $border; background:$card; box-shadow:$shadow; animation: toast-in .2s ease; }
.toast .icon { display:grid; place-items:center; width:28px; height:28px; border-radius:8px; background:rgba($primary,.1); color:$primary; }
.toast .content { flex:1; }
.toast .close { border:none; background:transparent; cursor:pointer; color:$text2; }
.toast.success .icon { background:rgba($primary,.12); color:$primary; }
.toast.error { border-color:#ffcdd2; background:#ffebee; }
.toast.error .icon { background:#ffcdd2; color:#b00020; }
.toast.info .icon { background:rgba(0,0,0,.06); color:$text2; }
@keyframes toast-in { from { opacity:0; transform: translateY(-6px) } to { opacity:1; transform: translateY(0) } }

/* Carousel */
.carousel { position:relative; }
.carousel .track { display:flex; gap:12px; overflow-x:auto; padding:2px; scroll-snap-type:x mandatory; -webkit-overflow-scrolling:touch; }
.carousel .item { scroll-snap-align:start; min-width:260px; }
.carousel .nav { position:absolute; inset:0; display:flex; align-items:center; justify-content:space-between; pointer-events:none; }
.carousel .nav button { pointer-events:auto; border:none; background:rgba(255,255,255,.85); backdrop-filter:saturate(1.4) blur(8px); width:36px; height:36px; border-radius:50%; display:grid; place-items:center; box-shadow:0 6px 20px rgba(0,0,0,.15); cursor:pointer; }

/* Reveal */
.reveal { opacity:0; transform: translateY(10px); transition: opacity .6s cubic-bezier(.2,.8,.2,1), transform .6s cubic-bezier(.2,.8,.2,1); }
.reveal-visible { opacity:1; transform: translateY(0); }

/* Page enter */
.page-enter { animation: page-in .35s cubic-bezier(.2,.8,.2,1); }
@keyframes page-in { from { opacity:0; transform: translateY(8px) } to { opacity:1; transform: translateY(0) } }

/* Ripple */
.btn { position:relative; overflow:hidden; }
.btn .ripple { position:absolute; border-radius:50%; transform:scale(0); animation: ripple .6s ease-out; pointer-events:none; background:rgba(255,255,255,.6); }
@keyframes ripple { to { transform:scale(4); opacity:0 } }

/* Bottom nav indicator */
.pg-bottom-nav { --nav-x:0px; --nav-w:0px; }
.pg-bottom-nav::after { content:""; position:absolute; bottom:0; left:var(--nav-x); width:var(--nav-w); height:3px; background:$primary; border-radius:999px; transition:left .25s ease, width .25s ease; }

/* Skeleton */
.skeleton { position:relative; overflow:hidden; background:#eee; }
.skeleton::after { content:""; position:absolute; inset:0; transform: translateX(-100%); background: linear-gradient(90deg, rgba(255,255,255,0), rgba(255,255,255,.6), rgba(255,255,255,0)); animation: shimmer 1.1s infinite; }
@keyframes shimmer { 100% { transform: translateX(100%) } }

/* Dark mode (data attribute) */
html[data-theme="dark"] body { color:#e6e6e6; background:#0f1115; }
html[data-theme="dark"] .pg-header, html[data-theme="dark"] .pg-bottom-nav, html[data-theme="dark"] .card { background: rgba(23,25,31,.75); border-color: rgba(255,255,255,.08); backdrop-filter: saturate(1.5) blur(10px); }
html[data-theme="dark"] .btn-ghost { color:#f8e5df; border-color: rgba(255,255,255,.12); }
